<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>game 1</title>
    <style>
        canvas {
            border: 1px solid black;
        }
    </style>
</head>
<body>
<canvas id="id-canvas" width="400" height="300"></canvas>

<script>
    var log = console.log.bind(console)

    var imageFromPath = function(path) {

        var img = new Image()
        img.src = path
        // img.onload = function() {
        //     context.drawImage(img, x, y)
        // }
        return img
    }

    var Paddle = function() {
        var image = imageFromPath('paddle.png')
        var o = {
            image: image,
            x: 100,
            y: 200,
            speed: 5,
        }

        return o
    }

    var __main = function() {
        var canvas = document.querySelector('#id-canvas')
        var context = canvas.getContext('2d')

       var paddle = Paddle()

        var leftDown = false
        var rightDown = false

        // events
        window.addEventListener('keydown', function(event) {
            var k = event.key
            if(k == 'a') {
                leftDown = true
            } else if(k == 'd') {
                rightDown = true
            }
        })

        window.addEventListener('keyup', function(event) {
            var k = event.key
            if(k == 'a') {
                leftDown = false
            } else if(k == 'd') {
                rightDown = false
            }
        })

        setInterval(function() {
            // update
            if(leftDown) {
                paddle.x -= paddle.speed
            } else if(rightDown) {
                paddle.x += paddle.speed
            }

            // TODO clamp x

            // draw
            context.clearRect(0, 0, canvas.width, canvas.height)
            context.drawImage(paddle.image, paddle.x, paddle.y)
        }, 1000/30)

    }

    __main()

</script>
</body>
</html>
